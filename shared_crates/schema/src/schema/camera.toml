[ember]
id = "camera"
name = "Camera"
description = "Camera matrices, types, parameters, and more."

[components.active-camera]
type = "f32"
name = "Active camera"
description = """
The camera with the highest `active-camera` value will be used for rendering. Cameras are also filtered by the `user-id`.
If there's no `user-id`, the camera is considered global and potentially applies to all users (if its `active-camera` value is high enough)."""
attributes = ["debuggable", "networked", "store"]

[components.aspect-ratio]
type = "f32"
name = "Aspect ratio"
description = """
The aspect ratio of this camera.
If `aspect-ratio-from-window` is set, this will be automatically updated to match the window."""
attributes = ["debuggable", "networked", "store"]

[components.aspect-ratio-from-window]
type = "entity-id"
name = "Aspect ratio from window"
description = "If attached, the `aspect-ratio` component will be automatically updated to match the aspect ratio of the window. Should point to an entity with a `window-physical-size` component."
attributes = ["debuggable", "networked", "store"]

[components.far]
type = "f32"
name = "Far plane"
description = "The far plane of this camera, measured in meters."
attributes = ["debuggable", "networked", "store"]

[components.fog]
type = "empty"
name = "Fog"
description = "If attached, this camera will see/render fog."
attributes = ["debuggable", "networked", "store"]

[components.fovy]
type = "f32"
name = "Field of View Y"
description = "The field of view of this camera in the Y/vertical direction, measured in radians."
attributes = ["debuggable", "networked", "store"]

[components.near]
type = "f32"
name = "Near plane"
description = "The near plane of this camera, measured in meters."
attributes = ["debuggable", "networked", "store"]

[components.orthographic]
type = "empty"
name = "Orthographic projection"
description = """
If attached, this camera will use a standard orthographic projection matrix.
Ensure that the `orthographic-` components are set, including `left`, right`, `top` and `bottom`, as well as `near` and `far`."""
attributes = ["debuggable", "networked", "store"]

[components.orthographic-bottom]
type = "f32"
name = "Orthographic bottom"
description = "The bottom bound for this `orthographic` camera."
attributes = ["debuggable", "networked", "store"]

[components.orthographic-from-window]
type = "entity-id"
name = "Orthographic from window"
description = "The bounds of this orthographic camera will be updated to match the window automatically. Should point to an entity with a `window-logical-size` component."
attributes = ["debuggable", "networked", "store"]

[components.orthographic-left]
type = "f32"
name = "Orthographic left"
description = "The left bound for this `orthographic` camera."
attributes = ["debuggable", "networked", "store"]

[components.orthographic-right]
type = "f32"
name = "Orthographic right"
description = "The right bound for this `orthographic` camera."
attributes = ["debuggable", "networked", "store"]

[components.orthographic-top]
type = "f32"
name = "Orthographic top"
description = "The top bound for this `orthographic` camera."
attributes = ["debuggable", "networked", "store"]

[components.perspective]
type = "empty"
name = "Perspective projection"
description = """
If attached, this camera will use a standard perspective projection matrix.
Ensure that `near` and `far` are set."""
attributes = ["debuggable", "networked", "store"]

[components.perspective-infinite-reverse]
type = "empty"
name = "Perspective-infinite-reverse projection"
description = """
If attached, this camera will use a perspective-infinite-reverse projection matrix.
This is well-suited for rendering large worlds as it has no far plane. Ensure `near` is set."""
attributes = ["debuggable", "networked", "store"]

[components.projection]
type = "mat4"
name = "Projection"
description = """
The projection matrix of this camera.
This can be driven by other components, including `perspective` and `perspective-infinite-reverse`."""
attributes = ["debuggable", "networked", "store"]

[components.projection-view]
type = "mat4"
name = "Projection-view"
description = "The composition of the projection and view (inverse-local-to-world) matrices."
attributes = ["debuggable", "networked", "store"]

[components.shadows-far]
type = "f32"
name = "Shadows far plane"
description = "The far plane for the shadow camera, measured in meters."
attributes = ["debuggable", "networked", "store"]

# Concepts

[concepts.camera]
name = "Camera"
description = "Base components for a camera. You will need other components to make a fully-functioning camera."
extends = ["transform/transformable"]

[concepts.camera.components]
near = 0.1
projection = [1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0]
projection-view = [1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0]
active-camera = 0.0
"transform/local-to-world" = [1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0]
"transform/inv-local-to-world" = [1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0]

[concepts.perspective-common-camera]
name = "Perspective Common Camera"
description = "Base components for a perspective camera. Consider `perspective-camera` or `perspective-infinite-reverse-camera`."
extends = ["camera"]

[concepts.perspective-common-camera.components]
fovy = 1.0
aspect-ratio = 1.0

[concepts.perspective-camera]
name = "Perspective Camera"
description = "A perspective camera."
extends = ["perspective-common-camera"]

[concepts.perspective-camera.components]
perspective = {}
far = 1000.0

[concepts.perspective-infinite-reverse-camera]
name = "Perspective-Infinite-Reverse Camera"
description = "A perspective-infinite-reverse camera. This is recommended for most use-cases."
extends = ["perspective-common-camera"]

[concepts.perspective-infinite-reverse-camera.components]
perspective-infinite-reverse = {}

[concepts.orthographic-camera]
name = "Orthographic Camera"
description = "An orthographic camera."
extends = ["camera"]

[concepts.orthographic-camera.components]
orthographic = {}
orthographic-left = -1.0
orthographic-right = 1.0
orthographic-top = 1.0
orthographic-bottom = -1.0
near = -1.0
far = 1.0
